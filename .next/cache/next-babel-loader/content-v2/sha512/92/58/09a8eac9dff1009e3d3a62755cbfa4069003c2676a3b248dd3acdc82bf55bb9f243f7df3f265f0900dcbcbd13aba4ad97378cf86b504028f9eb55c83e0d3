{"ast":null,"code":"import _regeneratorRuntime from \"/Users/zhengyiting/ReactProjects/orange-web/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/zhengyiting/ReactProjects/orange-web/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _s = $RefreshSig$();\n\nimport { cartActions } from \"./cart-slice\";\nimport useHttp from \"../hooks/use-http\";\nvar url = \"https://react-http-3d73c-default-rtdb.firebaseio.com/orangecart.json\"; //read\n\nexport var fetchingCartData = function fetchingCartData() {\n  _s();\n\n  //會自動 export action({type:'addToCart',ammount:1}) 也可以直接export方法出去\n  var _useHttp = useHttp(),\n      isLoading = _useHttp.isLoading,\n      error = _useHttp.error,\n      sendRequest = _useHttp.sendRequest;\n\n  return /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch) {\n      var fetchData, fetchingData;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              fetchData = /*#__PURE__*/function () {\n                var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n                  var response, data;\n                  return _regeneratorRuntime.wrap(function _callee$(_context) {\n                    while (1) {\n                      switch (_context.prev = _context.next) {\n                        case 0:\n                          _context.next = 2;\n                          return fetch(url);\n\n                        case 2:\n                          response = _context.sent;\n\n                          if (response.ok) {\n                            _context.next = 5;\n                            break;\n                          }\n\n                          throw new Error('Fetching data failed!');\n\n                        case 5:\n                          _context.next = 7;\n                          return response.json();\n\n                        case 7:\n                          data = _context.sent;\n                          return _context.abrupt(\"return\", data);\n\n                        case 9:\n                        case \"end\":\n                          return _context.stop();\n                      }\n                    }\n                  }, _callee);\n                }));\n\n                return function fetchData() {\n                  return _ref2.apply(this, arguments);\n                };\n              }();\n\n              _context2.prev = 1;\n              _context2.next = 4;\n              return fetchData();\n\n            case 4:\n              fetchingData = _context2.sent;\n              dispatch(cartActions.replaceCart({\n                items: data.items || [],\n                totalQuantity: data.totalQuantity,\n                totalPrice: data.totalPrice\n              })); //當物件全刪，firebase totalQuantity=0 items 會消失，重刷執行replaceCart會map不到items，因此給預設值空[]\n\n              _context2.next = 11;\n              break;\n\n            case 8:\n              _context2.prev = 8;\n              _context2.t0 = _context2[\"catch\"](1);\n              console.log(_context2.t0.message);\n\n            case 11:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[1, 8]]);\n    }));\n\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n}; //update\n\n_s(fetchingCartData, \"CCnshfZlH2rzEybPx6MnKYOG61s=\", false, function () {\n  return [useHttp];\n});\n\nexport var sendingCartData = function sendingCartData(cartData) {\n  // const { isLoading, error, sendRequest } = useHttp();\n  return /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch) {\n      var applyData, reqeustData;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              applyData = function applyData(data) {\n                console.log(\"Sent cart successfully\");\n              };\n\n              reqeustData = {\n                url: url,\n                method: \"PUT\",\n                body: {\n                  items: cartData.items,\n                  totalQuantity: cartData.totalQuantity,\n                  totalPrice: data.totalPrice\n                }\n              }; // sendRequest(reqeustData, applyData);\n\n            case 2:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function (_x2) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n};","map":{"version":3,"sources":["/Users/zhengyiting/ReactProjects/orange-web/store/cart-action.js"],"names":["cartActions","useHttp","url","fetchingCartData","isLoading","error","sendRequest","dispatch","fetchData","fetch","response","ok","Error","json","data","fetchingData","replaceCart","items","totalQuantity","totalPrice","console","log","message","sendingCartData","cartData","applyData","reqeustData","method","body"],"mappings":";;;;;AAAA,SAASA,WAAT,QAA4B,cAA5B;AACA,OAAOC,OAAP,MAAoB,mBAApB;AAEA,IAAMC,GAAG,GACP,sEADF,C,CAIA;;AACA,OAAO,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB,GAAM;AAAA;;AACpC;AADoC,iBAEMF,OAAO,EAFb;AAAA,MAE5BG,SAF4B,YAE5BA,SAF4B;AAAA,MAEjBC,KAFiB,YAEjBA,KAFiB;AAAA,MAEVC,WAFU,YAEVA,WAFU;;AAIpC;AAAA,wEAAO,kBAAOC,QAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAECC,cAAAA,SAFD;AAAA,qFAEa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iCACOC,KAAK,CAACP,GAAD,CADZ;;AAAA;AACVQ,0BAAAA,QADU;;AAAA,8BAEZA,QAAQ,CAACC,EAFG;AAAA;AAAA;AAAA;;AAAA,gCAGN,IAAIC,KAAJ,CAAU,uBAAV,CAHM;;AAAA;AAAA;AAAA,iCAKGF,QAAQ,CAACG,IAAT,EALH;;AAAA;AAKVC,0BAAAA,IALU;AAAA,2DAMTA,IANS;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAFb;;AAAA,gCAECN,SAFD;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,qBAYwBA,SAAS,EAZjC;;AAAA;AAYEO,cAAAA,YAZF;AAaJR,cAAAA,QAAQ,CAACP,WAAW,CAACgB,WAAZ,CAAwB;AAChCC,gBAAAA,KAAK,EAAEH,IAAI,CAACG,KAAL,IAAc,EADW;AAEhCC,gBAAAA,aAAa,EAAEJ,IAAI,CAACI,aAFY;AAGhCC,gBAAAA,UAAU,EAAGL,IAAI,CAACK;AAHc,eAAxB,CAAD,CAAR,CAbI,CAkBJ;;AAlBI;AAAA;;AAAA;AAAA;AAAA;AAoBHC,cAAAA,OAAO,CAACC,GAAR,CAAY,aAAMC,OAAlB;;AApBG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAP;;AAAA;AAAA;AAAA;AAAA;AAuBD,CA3BM,C,CA6BP;;GA7BanB,gB;UAE+BF,O;;;AA4B5C,OAAO,IAAMsB,eAAe,GAAG,SAAlBA,eAAkB,CAACC,QAAD,EAAc;AAC3C;AACA;AAAA,yEAAO,kBAAOjB,QAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACCkB,cAAAA,SADD,GACa,SAAZA,SAAY,CAACX,IAAD,EAAU;AAC1BM,gBAAAA,OAAO,CAACC,GAAR,CAAY,wBAAZ;AACD,eAHI;;AAKCK,cAAAA,WALD,GAKe;AAClBxB,gBAAAA,GAAG,EAAEA,GADa;AAElByB,gBAAAA,MAAM,EAAE,KAFU;AAGlBC,gBAAAA,IAAI,EAAE;AACJX,kBAAAA,KAAK,EAAEO,QAAQ,CAACP,KADZ;AAEJC,kBAAAA,aAAa,EAAEM,QAAQ,CAACN,aAFpB;AAGJC,kBAAAA,UAAU,EAAGL,IAAI,CAACK;AAHd;AAHY,eALf,EAeL;;AAfK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAP;;AAAA;AAAA;AAAA;AAAA;AAiBD,CAnBM","sourcesContent":["import { cartActions } from \"./cart-slice\";\nimport useHttp from \"../hooks/use-http\";\n\nconst url =\n  \"https://react-http-3d73c-default-rtdb.firebaseio.com/orangecart.json\";\n\n\n//read\nexport const fetchingCartData = () => {\n  //會自動 export action({type:'addToCart',ammount:1}) 也可以直接export方法出去\n  const { isLoading, error, sendRequest } = useHttp();\n\n  return async (dispatch) => {\n\n    const fetchData = async ()=>{\n      const response = await fetch(url);\n      if(!response.ok){\n          throw new Error('Fetching data failed!')\n      }\n      const data = await response.json()\n      return data\n  }\n\n  try{\n     const fetchingData =  await fetchData();\n     dispatch(cartActions.replaceCart({\n      items: data.items || [],\n      totalQuantity: data.totalQuantity,\n      totalPrice : data.totalPrice\n     }));\n     //當物件全刪，firebase totalQuantity=0 items 會消失，重刷執行replaceCart會map不到items，因此給預設值空[]\n  }catch(error){\n      console.log(error.message)\n  }\n  };\n};\n\n//update\nexport const sendingCartData = (cartData) => {\n  // const { isLoading, error, sendRequest } = useHttp();\n  return async (dispatch) => {\n    const applyData = (data) => {\n      console.log(\"Sent cart successfully\");\n    };\n\n    const reqeustData = {\n      url: url,\n      method: \"PUT\",\n      body: {\n        items: cartData.items,\n        totalQuantity: cartData.totalQuantity,\n        totalPrice : data.totalPrice\n      },\n    };\n\n    // sendRequest(reqeustData, applyData);\n  };\n};\n"]},"metadata":{},"sourceType":"module"}