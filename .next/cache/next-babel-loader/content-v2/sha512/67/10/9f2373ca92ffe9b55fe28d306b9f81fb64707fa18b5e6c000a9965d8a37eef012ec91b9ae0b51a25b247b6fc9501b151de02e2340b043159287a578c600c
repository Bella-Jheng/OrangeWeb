{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useState, useRef } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport Link from \"next/link\";\nimport classes from \"./index.module.css\";\nimport useHttp from \"../../hooks/use-http\";\nimport { useRouter } from \"next/router\";\nimport { useDispatch } from \"react-redux\";\nimport { cartActions } from \"../../store/cart-slice\";\nimport AuthContext from \"../../store/auth-context\";\nimport Banner from \"../../components/layout/Banner\";\nimport Alert from \"../../components/UI/Alert\";\nimport KeyboardArrowDownIcon from \"@mui/icons-material/KeyboardArrowDown\";\nimport Collapse from \"@material-ui/core/Collapse\";\nimport { GreenButton } from \"../../components/UI/Button\";\nimport ShoppingCartIcon from \"@mui/icons-material/ShoppingCart\";\n\nvar index = function index() {\n  var _useState = useState({\n    cartData: {},\n    custData: {}\n  }),\n      formData = _useState[0],\n      setFormData = _useState[1];\n\n  var authCtx = useContext(AuthContext);\n  var router = useRouter();\n  var dispatch = useDispatch(); //處理訂單對話框\n\n  var _useState2 = useState(false),\n      alertOpen = _useState2[0],\n      setAlertOpen = _useState2[1];\n\n  var handleAlertOpen = function handleAlertOpen() {\n    setAlertOpen(true);\n  };\n\n  var handleAlertClose = function handleAlertClose() {\n    setAlertOpen(false);\n  }; //購物車內容\n\n\n  var cart = useSelector(function (state) {\n    return state.cart;\n  });\n\n  var _useHttp = useHttp(),\n      isLoading = _useHttp.isLoading,\n      error = _useHttp.error,\n      sendRequest = _useHttp.sendRequest;\n\n  var _useState3 = useState(false),\n      expanded = _useState3[0],\n      setExpanded = _useState3[1];\n\n  var handleExpandClick = function handleExpandClick() {\n    setExpanded(!expanded);\n  }; //清除購物車\n\n\n  var removeFromCartHandler = function removeFromCartHandler() {\n    dispatch(cartActions.removeFromCart({\n      id: \"\",\n      size: \"\"\n    }));\n  }; //訂單資訊\n\n\n  var _useState4 = useState({\n    nameState: false,\n    emailState: false,\n    phoneState: false,\n    cardNumberState: false,\n    cardOwnerState: false,\n    cardDateState: false,\n    saftyNumberState: false,\n    sendWayState: false,\n    sendAddrState: false,\n    sendNameState: false,\n    sendPhoneState: false,\n    recieptTypeState: false,\n    recieptState: false\n  }),\n      isFormInvalid = _useState4[0],\n      setFormIsInvalid = _useState4[1];\n\n  var formIsValid = false;\n\n  var isEmpty = function isEmpty(value) {\n    return value.trim() === \"\";\n  };\n\n  var isThreeChart = function isThreeChart(value) {\n    return value.trim().length === 3;\n  }; //顧客資料\n\n\n  var name = useRef();\n  var email = useRef();\n  var phone = useRef(); //付款資料\n\n  var cardNumber = useRef();\n  var cardOwner = useRef();\n  var cardDate = useRef();\n  var saftyNumber = useRef(); //送貨資料\n\n  var sendWay = useRef();\n  var sendAddr = useRef();\n  var sendName = useRef();\n  var sendPhone = useRef(); //發票\n\n  var recieptType = useRef();\n  var reciept = useRef();\n\n  var comfirmDataHandler = function comfirmDataHandler(event) {\n    event.preventDefault();\n    var enterName = name.current.value;\n    var enterEmail = email.current.value;\n    var enterPhone = phone.current.value;\n    var enterCardNumber = cardNumber.current.value;\n    var enterCardOwner = cardOwner.current.value;\n    var enterCardDate = cardDate.current.value;\n    var enterSaftyNumber = saftyNumber.current.value;\n    var enterSendWay = sendWay.current.value;\n    var enterSendAddr = sendAddr.current.value;\n    var enterSendName = sendName.current.value;\n    var enterSendPhone = sendPhone.current.value;\n    var enterRecieptType = recieptType.current.value;\n    var enterReciept = reciept.current.value;\n    var enterNameIsInvalid = isEmpty(enterName);\n    var enterEmailIsInvalid = isEmpty(enterEmail);\n    var enterPhoneIsInvalid = isEmpty(enterPhone);\n    var enterCardNumberIsInvalid = isEmpty(enterCardNumber);\n    var enterCardOwnerIsInvalid = isEmpty(enterCardOwner);\n    var enterCardDateIsInvalid = isEmpty(enterCardDate);\n    var enterSaftyNumberIsInvalid = !isThreeChart(enterSaftyNumber);\n    var enterSendWayIsInvalid = isEmpty(enterSendWay);\n    var enterSendAddrIsInvalid = isEmpty(enterSendAddr);\n    var enterSendNameIsInvalid = isEmpty(enterSendName);\n    var enterSendPhoneIsInvalid = isEmpty(enterSendPhone);\n    var enterRecieptTypeIsInvalid = isEmpty(enterRecieptType);\n    var enterRecieptIsInvalid = isEmpty(enterReciept);\n    setFormIsInvalid({\n      nameState: enterNameIsInvalid,\n      emailState: enterEmailIsInvalid,\n      phoneState: enterPhoneIsInvalid,\n      cardNumberState: enterCardNumberIsInvalid,\n      cardOwnerState: enterCardOwnerIsInvalid,\n      cardDateState: enterCardDateIsInvalid,\n      saftyNumberState: enterSaftyNumberIsInvalid,\n      sendWayState: enterSendWayIsInvalid,\n      sendAddrState: enterSendAddrIsInvalid,\n      sendNameState: enterSendNameIsInvalid,\n      sendPhoneState: enterSendPhoneIsInvalid,\n      recieptTypeState: enterRecieptTypeIsInvalid,\n      recieptState: enterRecieptIsInvalid\n    });\n    formIsValid = !enterNameIsInvalid && !enterEmailIsInvalid && !enterPhoneIsInvalid && !enterCardNumberIsInvalid && !enterCardOwnerIsInvalid && !enterCardDateIsInvalid && !enterSaftyNumberIsInvalid && !enterSendWayIsInvalid && !enterSendAddrIsInvalid && !enterSendNameIsInvalid && !enterSendPhoneIsInvalid && !enterRecieptTypeIsInvalid && !enterRecieptIsInvalid;\n\n    if (!formIsValid) {\n      return;\n    }\n\n    setFormData({\n      cartData: {\n        cart: cart\n      },\n      custData: {\n        enterName: enterName,\n        enterEmail: enterEmail,\n        enterPhone: enterPhone,\n        enterCardNumber: enterCardNumber,\n        enterCardOwner: enterCardOwner,\n        enterCardDate: enterCardDate,\n        enterSaftyNumber: enterSaftyNumber,\n        enterSendWay: enterSendWay,\n        enterSendAddr: enterSendAddr,\n        enterSendName: enterSendName,\n        enterSendPhone: enterSendPhone,\n        enterRecieptType: enterRecieptType,\n        enterReciept: enterReciept\n      }\n    });\n    handleAlertOpen();\n  };\n\n  var onSubmitHandler = function onSubmitHandler() {\n    var requestData = {\n      url: \"https://react-http-3d73c-default-rtdb.firebaseio.com/orangeorder.json\",\n      method: \"POST\",\n      body: {\n        custToken: authCtx.token ? authCtx.token : null,\n        cartData: formData.cartData,\n        custData: formData.custData\n      }\n    };\n\n    var applyData = function applyData(responseData) {\n      console.log(requestData);\n    };\n\n    sendRequest(requestData, applyData);\n    removeFromCartHandler();\n    handleAlertClose();\n    router.push(\"/\");\n  };\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: classes.container,\n    children: [/*#__PURE__*/_jsx(Alert, {\n      openAlert: alertOpen,\n      handleClose: handleAlertClose,\n      handleAgree: onSubmitHandler,\n      title: \"\\u9001\\u51FA\\u8A02\\u55AE\",\n      alertContent: \"\\u9001\\u51FA\\u5F8C\\u7121\\u6CD5\\u4FEE\\u6539\\uFF0C\\u78BA\\u5B9A\\u8981\\u9001\\u51FA\\u8A02\\u55AE\\u55CE\\uFF1F\",\n      disagree: true\n    }), /*#__PURE__*/_jsx(Banner, {\n      title: \"\\u8A02\\u55AE\\u78BA\\u8A8D\"\n    }), cart.items.length === 0 ? /*#__PURE__*/_jsx(\"div\", {\n      className: classes.wrapper,\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        className: classes.cartEmptyContainer,\n        children: [/*#__PURE__*/_jsx(ShoppingCartIcon, {\n          style: {\n            fontSize: 150,\n            color: \"gray\"\n          }\n        }), /*#__PURE__*/_jsx(\"br\", {}), /*#__PURE__*/_jsx(Link, {\n          href: \"/product-list\",\n          children: /*#__PURE__*/_jsx(GreenButton, {\n            title: \"\\u7E7C\\u7E8C\\u8CFC\\u7269\",\n            width: \"200px\"\n          })\n        })]\n      })\n    }) : /*#__PURE__*/_jsxs(\"div\", {\n      className: classes.wrapper,\n      children: [/*#__PURE__*/_jsxs(\"div\", {\n        className: classes.cartContainer,\n        children: [/*#__PURE__*/_jsxs(\"div\", {\n          className: classes.cartHeader,\n          onClick: handleExpandClick,\n          children: [/*#__PURE__*/_jsxs(\"h2\", {\n            children: [\"\\u5408\\u8A08: NT$ \", cart.totalPrice]\n          }), /*#__PURE__*/_jsx(KeyboardArrowDownIcon, {})]\n        }), /*#__PURE__*/_jsxs(Collapse, {\n          style: {\n            flex: \"100%\"\n          },\n          \"in\": expanded,\n          timeout: \"auto\",\n          unmountOnExit: true,\n          children: [/*#__PURE__*/_jsxs(\"div\", {\n            className: classes.column,\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              className: classes.cartMainPart,\n              children: \"\\u5546\\u54C1\\u8CC7\\u6599\"\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: classes.cartInfor,\n              children: \"\\u55AE\\u4EF6\\u50F9\\u683C\"\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: classes.cartInfor,\n              children: \"\\u6578\\u91CF\"\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: classes.cartInfor,\n              children: \"\\u5C0F\\u8A08\"\n            })]\n          }), cart.items.map(function (item) {\n            return /*#__PURE__*/_jsxs(\"div\", {\n              className: classes.column,\n              children: [/*#__PURE__*/_jsxs(\"div\", {\n                className: classes.cartMainPart,\n                children: [/*#__PURE__*/_jsx(\"img\", {\n                  src: item.img\n                }), /*#__PURE__*/_jsx(\"p\", {\n                  children: item.name\n                })]\n              }), /*#__PURE__*/_jsxs(\"div\", {\n                className: classes.cartInfor,\n                children: [\"NT$ \", item.price]\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: classes.cartInfor,\n                children: item.quantity\n              }), /*#__PURE__*/_jsxs(\"div\", {\n                className: classes.cartInfor,\n                children: [\"NT$ \", item.totalPrice]\n              })]\n            }, item.id);\n          })]\n        })]\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: classes.custinforContainer,\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: classes.custHeaderColumn,\n            children: /*#__PURE__*/_jsx(\"div\", {\n              children: \"\\u9867\\u5BA2\\u8CC7\\u8A0A\"\n            })\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: classes.column,\n            children: [/*#__PURE__*/_jsxs(\"div\", {\n              className: classes.custColumn,\n              children: [/*#__PURE__*/_jsx(\"p\", {\n                children: \"\\u9867\\u5BA2\\u59D3\\u540D\"\n              }), /*#__PURE__*/_jsx(\"input\", {\n                defaultValue: \"\\u912D\\u4F0A\\u5A77\",\n                ref: name\n              }), isFormInvalid.nameState && /*#__PURE__*/_jsx(\"p\", {\n                className: classes.invalid,\n                children: \"\\u8ACB\\u8F38\\u5165\\u59D3\\u540D\"\n              })]\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: classes.custColumn,\n              children: [/*#__PURE__*/_jsx(\"p\", {\n                children: \"\\u96FB\\u5B50\\u4FE1\\u7BB1\"\n              }), /*#__PURE__*/_jsx(\"input\", {\n                defaultValue: \"bz850308@gmail.com\",\n                type: \"email\",\n                ref: email\n              }), isFormInvalid.emailState && /*#__PURE__*/_jsx(\"p\", {\n                className: classes.invalid,\n                children: \"\\u8ACB\\u8F38\\u5165Email\"\n              })]\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: classes.custColumn,\n              children: [/*#__PURE__*/_jsx(\"p\", {\n                children: \"\\u96FB\\u8A71\\u865F\\u78BC\"\n              }), /*#__PURE__*/_jsx(\"input\", {\n                ref: phone,\n                maxLength: \"10\"\n              }), isFormInvalid.phoneState && /*#__PURE__*/_jsx(\"p\", {\n                className: classes.invalid,\n                children: \"\\u8ACB\\u8F38\\u5165\\u96FB\\u8A71\"\n              })]\n            })]\n          })]\n        })\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: classes.custinforContainer,\n        children: [/*#__PURE__*/_jsxs(\"div\", {\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: classes.custHeaderColumn,\n            children: /*#__PURE__*/_jsx(\"div\", {\n              children: \"\\u4ED8\\u6B3E\\u8CC7\\u6599\"\n            })\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: classes.column,\n            children: [/*#__PURE__*/_jsxs(\"div\", {\n              className: classes.custColumn,\n              children: [/*#__PURE__*/_jsx(\"p\", {\n                children: \"\\u5361\\u865F\"\n              }), /*#__PURE__*/_jsx(\"input\", {\n                type: \"number\",\n                ref: cardNumber\n              }), isFormInvalid.cardNumberState && /*#__PURE__*/_jsx(\"p\", {\n                className: classes.invalid,\n                children: \"\\u8ACB\\u8F38\\u5165\\u5361\\u865F\"\n              })]\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: classes.custColumn,\n              children: [/*#__PURE__*/_jsx(\"p\", {\n                children: \"\\u6301\\u5361\\u4EBA\\u59D3\\u540D\"\n              }), /*#__PURE__*/_jsx(\"input\", {\n                ref: cardOwner\n              }), isFormInvalid.cardOwnerState && /*#__PURE__*/_jsx(\"p\", {\n                className: classes.invalid,\n                children: \"\\u8ACB\\u8F38\\u5165\\u6301\\u5361\\u4EBA\\u59D3\\u540D\"\n              })]\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: classes.custColumn,\n              children: [/*#__PURE__*/_jsx(\"p\", {\n                children: \"\\u6709\\u6548\\u65E5\\u671F(MM/YY)\"\n              }), /*#__PURE__*/_jsx(\"input\", {\n                ref: cardDate\n              }), isFormInvalid.cardDateState && /*#__PURE__*/_jsx(\"p\", {\n                className: classes.invalid,\n                children: \"\\u8ACB\\u8F38\\u5165\\u6709\\u6548\\u65E5\\u671F\"\n              })]\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: classes.custColumn,\n              children: [/*#__PURE__*/_jsx(\"p\", {\n                children: \"\\u5B89\\u5168\\u78BC\"\n              }), /*#__PURE__*/_jsx(\"input\", {\n                type: \"number\",\n                ref: saftyNumber,\n                maxLength: \"3\"\n              }), isFormInvalid.saftyNumberState && /*#__PURE__*/_jsx(\"p\", {\n                className: classes.invalid,\n                children: \"\\u8ACB\\u8F38\\u5165\\u5B89\\u5168\\u78BC\"\n              })]\n            })]\n          })]\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: classes.custHeaderColumn,\n            children: /*#__PURE__*/_jsx(\"div\", {\n              children: \"\\u9001\\u8CA8\\u8CC7\\u6599\"\n            })\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: classes.column,\n            children: [/*#__PURE__*/_jsxs(\"div\", {\n              className: classes.custColumn,\n              children: [/*#__PURE__*/_jsx(\"p\", {\n                children: \"\\u6536\\u4EF6\\u4EBA\\u540D\\u7A31\"\n              }), /*#__PURE__*/_jsx(\"input\", {\n                defaultValue: \"\\u912D\\u4F0A\\u5A77\",\n                ref: sendName\n              }), isFormInvalid.sendNameState && /*#__PURE__*/_jsx(\"p\", {\n                className: classes.invalid,\n                children: \"\\u8ACB\\u8F38\\u5165\\u6536\\u4EF6\\u4EBA\\u540D\\u7A31\"\n              })]\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: classes.custColumn,\n              children: [/*#__PURE__*/_jsx(\"p\", {\n                children: \"\\u6536\\u4EF6\\u4EBA\\u96FB\\u8A71\\u865F\\u78BC\"\n              }), /*#__PURE__*/_jsx(\"input\", {\n                ref: sendPhone,\n                maxLength: \"10\"\n              }), isFormInvalid.sendPhoneState && /*#__PURE__*/_jsx(\"p\", {\n                className: classes.invalid,\n                children: \"\\u8ACB\\u8F38\\u5165\\u6536\\u4EF6\\u4EBA\\u96FB\\u8A71\\u865F\\u78BC\"\n              })]\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: classes.custColumn,\n              children: [/*#__PURE__*/_jsx(\"p\", {\n                children: \"\\u9001\\u8CA8\\u65B9\\u5F0F\"\n              }), /*#__PURE__*/_jsx(\"input\", {\n                defaultValue: \"\\u5B85\\u914D\",\n                ref: sendWay\n              }), isFormInvalid.sendWayState && /*#__PURE__*/_jsx(\"p\", {\n                className: classes.invalid,\n                children: \"\\u8ACB\\u8F38\\u5165\\u9001\\u8CA8\\u65B9\\u5F0F\"\n              })]\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: classes.custColumn,\n              children: [/*#__PURE__*/_jsx(\"p\", {\n                children: \"\\u9001\\u8CA8\\u5730\\u5740\"\n              }), /*#__PURE__*/_jsx(\"input\", {\n                ref: sendAddr\n              }), isFormInvalid.sendAddrState && /*#__PURE__*/_jsx(\"p\", {\n                className: classes.invalid,\n                children: \"\\u8ACB\\u8F38\\u5165\\u9001\\u8CA8\\u5730\\u5740\"\n              })]\n            })]\n          })]\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: classes.custHeaderColumn,\n            children: /*#__PURE__*/_jsx(\"div\", {\n              children: \"\\u767C\\u7968\\u8CC7\\u8A0A\"\n            })\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: classes.column,\n            children: [/*#__PURE__*/_jsxs(\"div\", {\n              className: classes.custColumn,\n              children: [/*#__PURE__*/_jsx(\"p\", {\n                children: \"\\u767C\\u7968\\u985E\\u578B\"\n              }), /*#__PURE__*/_jsx(\"select\", {\n                ref: recieptType,\n                defaultValue: \"\\u96F2\\u7AEF\\u767C\\u7968\",\n                children: /*#__PURE__*/_jsx(\"option\", {\n                  children: \"\\u96F2\\u7AEF\\u767C\\u7968\"\n                })\n              }), isFormInvalid.recieptTypeState && /*#__PURE__*/_jsx(\"p\", {\n                className: classes.invalid,\n                children: \"\\u8ACB\\u9078\\u64C7\\u96F2\\u7AEF\\u767C\\u7968\"\n              })]\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: classes.custColumn,\n              children: [/*#__PURE__*/_jsx(\"p\", {\n                children: \"\\u8F38\\u5165\\u8F09\\u5177\"\n              }), /*#__PURE__*/_jsx(\"input\", {\n                ref: reciept\n              }), isFormInvalid.recieptState && /*#__PURE__*/_jsx(\"p\", {\n                className: classes.invalid,\n                children: \"\\u8ACB\\u8F38\\u5165\\u8F09\\u5177\"\n              })]\n            })]\n          })]\n        })]\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: classes.bottomContainer,\n        children: /*#__PURE__*/_jsx(GreenButton, {\n          title: \"\\u9001\\u51FA\\u8A02\\u55AE\",\n          width: \"200px\",\n          onClick: comfirmDataHandler\n        })\n      })]\n    })]\n  });\n};\n\nexport default index;","map":null,"metadata":{},"sourceType":"module"}