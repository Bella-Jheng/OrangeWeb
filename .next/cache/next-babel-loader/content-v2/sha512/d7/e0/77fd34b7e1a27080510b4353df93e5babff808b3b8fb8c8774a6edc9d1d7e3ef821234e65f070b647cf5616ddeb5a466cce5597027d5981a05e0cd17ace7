{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"/Users/zhengyiting/ReactProjects/orange-web/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/zhengyiting/ReactProjects/orange-web/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport React, { useState, useContext } from \"react\";\nimport { useRouter } from \"next/router\";\nimport classes from \"./index.module.css\";\nimport Banner from \"../../components/layout/Banner\";\nimport Button, { GreenButton } from \"../../components/UI/Button\";\nimport Login from \"../../components/login/Login\";\nimport Register from \"../../components/login/Register\";\nimport useInput from \"../../hooks/use-input\";\nimport useHttp from \"../../hooks/use-http\";\nimport AuthContext from \"../../store/auth-context\";\n\nvar index = function index() {\n  var _useState = useState(true),\n      isLoginForm = _useState[0],\n      setLoginForm = _useState[1];\n\n  var authCtx = useContext(AuthContext);\n\n  var _useHttp = useHttp(),\n      isLoading = _useHttp.isLoading,\n      error = _useHttp.error,\n      sendRequest = _useHttp.sendRequest;\n\n  var router = useRouter();\n\n  var switchForm = function switchForm() {\n    setLoginForm(function (prevState) {\n      return !prevState;\n    });\n  };\n\n  var _useInput = useInput(function (value) {\n    return value.trim() !== \"\";\n  }),\n      name = _useInput.enterValue,\n      nameHasError = _useInput.hasError,\n      nameChangeHandler = _useInput.onEnterValueChangeHandler,\n      nameBlurHandler = _useInput.onInputIsTouchedHandler,\n      resetName = _useInput.reset;\n\n  var _useInput2 = useInput(function (value) {\n    var express = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n    return express.test(String(value).toLowerCase());\n  }),\n      email = _useInput2.enterValue,\n      emailHasError = _useInput2.hasError,\n      emailChangeHandler = _useInput2.onEnterValueChangeHandler,\n      emailBlurHandler = _useInput2.onInputIsTouchedHandler,\n      resetEmail = _useInput2.reset;\n\n  var _useInput3 = useInput(function (value) {\n    return value.trim() !== \"\";\n  }),\n      password = _useInput3.enterValue,\n      passwordHasError = _useInput3.hasError,\n      passwordChangeHandler = _useInput3.onEnterValueChangeHandler,\n      passwordBlurHandler = _useInput3.onInputIsTouchedHandler,\n      resetPassword = _useInput3.reset;\n\n  var _useInput4 = useInput(function (value) {\n    return value.trim() !== \"\";\n  }),\n      phone = _useInput4.enterValue,\n      phoneHasError = _useInput4.hasError,\n      phoneChangeHandler = _useInput4.onEnterValueChangeHandler,\n      phoneBlurHandler = _useInput4.onInputIsTouchedHandler,\n      resetPhone = _useInput4.reset;\n\n  var applyData = function applyData(responseData) {\n    var expirationTime = new Date(new Date().getTime() + responseData.expiresIn * 1000);\n    authCtx.login(responseData.idToken, expirationTime);\n  };\n\n  var onSubmitHandler = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(event) {\n      var requestData;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              event.preventDefault();\n              requestData = {};\n\n              if (!isLoginForm) {\n                _context.next = 8;\n                break;\n              }\n\n              if (!(emailHasError || passwordHasError)) {\n                _context.next = 5;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 5:\n              requestData = {\n                url: \"https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyAxz4_e9HdJ-sMLmffL-J1SneHjRr3NlDE\",\n                method: \"POST\",\n                body: {\n                  email: email,\n                  password: password,\n                  returnSecureToken: true\n                }\n              };\n              _context.next = 11;\n              break;\n\n            case 8:\n              if (!(emailHasError || passwordHasError || nameHasError || phoneHasError)) {\n                _context.next = 10;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 10:\n              requestData = {\n                url: \"https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyAxz4_e9HdJ-sMLmffL-J1SneHjRr3NlDE\",\n                method: \"POST\",\n                body: {\n                  email: email,\n                  password: password,\n                  displayName: name,\n                  phone: phone,\n                  returnSecureToken: true\n                }\n              };\n\n            case 11:\n              sendRequest(requestData, applyData);\n              resetEmail();\n              resetPassword();\n              resetName();\n              resetPhone();\n              router.push(\"/\");\n\n            case 17:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function onSubmitHandler(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var LoginPart = /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsx(Login, {\n      enterEmail: email,\n      enterEmailIsInvalid: emailHasError,\n      emailChangeHandler: emailChangeHandler,\n      emailBlurHandler: emailBlurHandler,\n      enterPassword: password,\n      enterPasswordIsInvalid: passwordHasError,\n      passwordChangeHandler: passwordChangeHandler,\n      passwordBlurHandler: passwordBlurHandler\n    }), /*#__PURE__*/_jsx(Button, {\n      title: \"\\u767B\\u5165\"\n    })]\n  });\n\n  var RegisterPart = /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsx(Register, {\n      enterEmail: email,\n      enterEmailIsInvalid: emailHasError,\n      emailChangeHandler: emailChangeHandler,\n      emailBlurHandler: emailBlurHandler,\n      enterPassword: password,\n      enterPasswordIsInvalid: passwordHasError,\n      passwordChangeHandler: passwordChangeHandler,\n      passwordBlurHandler: passwordBlurHandler,\n      enterName: name,\n      enterNameIsInvalid: nameHasError,\n      nameChangeHandler: nameChangeHandler,\n      nameBlurHandler: nameBlurHandler,\n      enterPhone: phone,\n      enterPhoneIsInvalid: phoneHasError,\n      phoneChangeHandler: phoneChangeHandler,\n      phoneBlurHandler: phoneBlurHandler\n    }), /*#__PURE__*/_jsx(GreenButton, {\n      title: \"\\u8A3B\\u518A\"\n    })]\n  });\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: classes.container,\n    children: [/*#__PURE__*/_jsx(Banner, {\n      title: \"\\u767B\\u5165\\u53CA\\u8A3B\\u518A\"\n    }), /*#__PURE__*/_jsx(\"div\", {\n      className: classes.wrapper,\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        className: classes.loginContainer,\n        children: [/*#__PURE__*/_jsxs(\"div\", {\n          className: classes.header,\n          children: [/*#__PURE__*/_jsx(\"a\", {\n            className: \"\".concat(classes.link) + \" \" + \"\".concat(isLoginForm && classes.visited),\n            onClick: switchForm,\n            children: \"\\u767B\\u5165\"\n          }), /*#__PURE__*/_jsx(\"span\", {\n            children: \"|\"\n          }), /*#__PURE__*/_jsx(\"a\", {\n            className: \"\".concat(classes.link) + \" \" + \"\".concat(!isLoginForm && classes.visited),\n            onClick: switchForm,\n            children: \"\\u8A3B\\u518A\"\n          })]\n        }), /*#__PURE__*/_jsx(\"form\", {\n          className: classes.form,\n          onSubmit: onSubmitHandler,\n          children: /*#__PURE__*/_jsx(\"div\", {\n            className: classes.inputContainer,\n            children: isLoginForm ? LoginPart : RegisterPart\n          })\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: classes.buttonContainer,\n          children: [/*#__PURE__*/_jsx(\"a\", {\n            className: classes.forgetPassword,\n            children: \"\\u5FD8\\u8A18\\u5BC6\\u78BC\\uFF1F\"\n          }), /*#__PURE__*/_jsx(\"h6\", {\n            className: classes.loginHorizontal,\n            children: /*#__PURE__*/_jsx(\"span\", {\n              children: \"\\u6216\\u8005\"\n            })\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: classes.googleLogin,\n            children: [/*#__PURE__*/_jsx(\"img\", {\n              src: \"https://img.icons8.com/fluency/15/000000/google-logo.png\"\n            }), /*#__PURE__*/_jsx(\"span\", {\n              children: \"google \\u5E33\\u865F\\u767B\\u5165\"\n            })]\n          })]\n        })]\n      })\n    })]\n  });\n};\n\nexport default index;","map":null,"metadata":{},"sourceType":"module"}